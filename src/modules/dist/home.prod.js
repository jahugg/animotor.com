"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=render;var _=_interopRequireDefault(require("./../media/animation/*.*"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function render(){var r,i,a,o,n=0,l=!1,d=document.createElement("div");d.classList.add("infinite-scroll-container"),d.innerHTML="loading",main.appendChild(d);var e=[];for(var t in _.default)for(var c in _.default[t])e.push(loadImage(_.default[t][c]));function s(e){e.preventDefault();var t=e.changedTouches;r=t[0].pageY,cancelAnimationFrame(a),cancelAnimationFrame(o)}function u(e){e.preventDefault(),i=r;var t=e.changedTouches,n=-1*(r-t[0].pageY);r=t[0].pageY,h(C()+n),v(n)}function m(e){e.preventDefault();var t=e.changedTouches,r=-1*(i-t[0].pageY);a=window.requestAnimationFrame(function e(t){var n=!!document.querySelector(".infinite-scroll");{n&&(r=Math.min(Math.max(r,-80),80),h(C()+r),v(r),r<.25?(r+=.25,a=window.requestAnimationFrame(e)):.25<r?(r-=.25,a=window.requestAnimationFrame(e)):(r=0,cancelAnimationFrame(a)))}})}function f(e){e.preventDefault();var t=-1*e.deltaY;h(C()+t),v(t),console.log(n,t),Math.abs(n)<=Math.abs(t)&&!l?(l=!0,console.log("wheel retriggered")):(l=!1,console.log("wheel slowing down")),n=t,150<Math.abs(t)&&console.log("trigger custom animation now: "+t),cancelAnimationFrame(a),cancelAnimationFrame(o)}function v(e){var t=Math.abs(e),n=map(t=Math.min(Math.max(t,0),80),0,80,1,.1),r=map(t,20,80,0,1),i=document.querySelector(".static-anim"),a=document.querySelector(".infinite-scroll");i.style.opacity=r,a.style.opacity=n}function C(){var e,t=document.querySelector(".infinite-scroll"),n=window.getComputedStyle(t).getPropertyValue("transform");return"none"===n?(t.style.transform="translateY(0)",0):(e=n.match(/matrix.*\((.+)\)/)[1].split(", "),parseInt(e[5],10))}function h(e){document.querySelector(".infinite-scroll").style.transform="translateY("+e+"px)"}function H(){var e=0,t=document.querySelector(".infinite-scroll"),n=document.createElement("div");n.classList.add("infinite-scroll__item");var r,i=Object.keys(_.default);t.hasChildNodes()&&(e=(r=parseInt(t.lastChild.getAttribute("data-id"),10))===i.length-1?0:r+1);var a="Untitled_Artwork-"+(e+1).toString();n.innerHTML='<img src="'+_.default[a].png+'">\n    <div>'+e+"</div>",n.setAttribute("data-id",e),t.appendChild(n)}Promise.all(e).then(function(e){d.innerHTML="";var t=Object.keys(_.default),n=document.createElement("div");n.classList.add("static-anim"),d.appendChild(n);var r=document.createElement("img");r.src=_.default[t[0]].png,r.setAttribute("data-id",0),n.appendChild(r);var i=document.createElement("div");i.classList.add("infinite-scroll"),d.appendChild(i);for(;i.scrollHeight<=window.innerHeight;)H();o=window.requestAnimationFrame(function e(){document.querySelector(".infinite-scroll")&&(h(C()+1),o=window.requestAnimationFrame(e))}),d.addEventListener("wheel",throttledEvent(f,5)),d.addEventListener("touchstart",s,!1),d.addEventListener("touchmove",throttledEvent(u,5),!1),d.addEventListener("touchend",m,!1),d.addEventListener("touchcancel",m,!1),new MutationObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if("attributes"===o.type&&"style"===o.attributeName){var l=document.querySelector(".infinite-scroll"),d=C(),c=l.firstChild,s=l.lastChild;Math.abs(d)>c.offsetHeight?(c.remove(),l.style.transform="translateY(0)"):l.offsetHeight-s.offsetHeight-Math.abs(d)>window.innerHeight&&s.remove(),0<d?function(){var e=0,t=document.querySelector(".infinite-scroll"),n=document.createElement("div");n.classList.add("infinite-scroll__item");var r=Object.keys(_.default),i=parseInt(t.firstChild.getAttribute("data-id"),10);e=0===i?r.length-1:i-1;var a="Untitled_Artwork-"+(e+1).toString();n.innerHTML='<img src="'+_.default[a].png+'">\n  <div>'+e+"</div>",n.setAttribute("data-id",e),t.prepend(n),t.style.transform="translateY("+-n.offsetHeight+"px)"}():window.innerHeight+Math.abs(d)>l.offsetHeight&&H();var u,m,f,v=document.getElementsByClassName("infinite-scroll__item"),h=document.querySelector(".static-anim"),g=h.getBoundingClientRect(),p=void 0,y=9999,w=!0,b=!1,q=void 0;try{for(var A,M=v[Symbol.iterator]();!(w=(A=M.next()).done);w=!0){var E=A.value,L=E.getBoundingClientRect(),S=Math.abs(L.top-g.top);S<y&&(y=S,p=E)}}catch(e){b=!0,q=e}finally{try{w||null==M.return||M.return()}finally{if(b)throw q}}p.getBoundingClientRect().top<=g.top&&(u=Object.keys(_.default),m=h.querySelector("img"),f=p.getAttribute("data-id"),m.src=_.default[u[f]].png,m.setAttribute("data-id",f))}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}).observe(i,{attributes:!0})}).catch(function(e){return console.error(e)})}function throttledEvent(t,n){var r;return function(e){r||(t(e),r=setTimeout(function(){r=null},n))}}function map(e,t,n,r,i){return(e-t)*(i-r)/(n-t)+r}function loadImage(r){return new Promise(function(e,t){var n=new Image;n.addEventListener("load",function(){return e(n)}),n.addEventListener("error",t),n.src=r})}