"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=render;var _=_interopRequireDefault(require("./../media/home/animations/*/*.*")),helpers=_interopRequireWildcard(require("./helpers.js"));function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e){Object.prototype.hasOwnProperty.call(e,a)&&((r=i?Object.getOwnPropertyDescriptor(e,a):null)&&(r.get||r.set)?Object.defineProperty(n,a,r):n[a]=e[a])}return n.default=e,t&&t.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function render(){var n,i,s,r=0,a=!1;document.querySelector("header").classList.replace("header--relative","header--fixed");var o=document.createElement("div");o.classList.add("infinite-scroll-container"),o.innerHTML='<div class="infinite-scroll-loader"><div>',document.getElementById("main").appendChild(o);for(var e=Object.keys(_.default),t=_.default[e[e.length*Math.random()<<0]],w=Object.values(t),O=Object.keys(w[0])[0],l=[],c=0,u=w;c<u.length;c++){var d=u[c];l.push(helpers.loadImage(d[O]))}function f(a,o){var l,c=a/o;s=window.requestAnimationFrame(function e(t){var r=!!document.querySelector(".infinite-scroll");{var n,i;r&&(void 0===l&&(l=t),i=(n=t-l)*c,i=helpers.map(i,0,a,a,0),g(j()+i),y(i),n<o&&(s=window.requestAnimationFrame(e)))}})}function m(e){e.preventDefault();var t=e.changedTouches;n=t[0].pageY,cancelAnimationFrame(s)}function p(e){e.preventDefault(),i=n;var t=e.changedTouches,r=-1*(n-t[0].pageY);n=t[0].pageY,g(j()+r),y(r)}function h(e){e.preventDefault();var t=e.changedTouches;f(-1*(i-t[0].pageY),4e3)}function v(e){e.preventDefault();var t=-1*e.deltaY;g(j()+t),y(t),a=Math.abs(r)<=Math.abs(t)&&!a,r=t,150<Math.abs(t)&&0,cancelAnimationFrame(s)}function y(e){var t=Math.abs(e),t=Math.min(Math.max(t,0),80),r=helpers.map(t,0,80,1,.1),n=helpers.map(t,20,80,0,1),i=document.querySelector(".static-anim"),a=document.querySelector(".infinite-scroll");i.style.opacity=n,a.style.opacity=r}function j(){var e,t=document.querySelector(".infinite-scroll"),r=window.getComputedStyle(t).getPropertyValue("transform");return"none"===r?(t.style.transform="translateY(0)",0):(e=r.match(/matrix.*\((.+)\)/)[1].split(", "),parseInt(e[5],10))}function g(e){document.querySelector(".infinite-scroll").style.transform="translateY("+e+"px)"}function A(){var e,t=0,r=document.querySelector(".infinite-scroll"),n=document.createElement("div");n.classList.add("infinite-scroll__item"),r.hasChildNodes()&&(t=(e=parseInt(r.lastChild.getAttribute("data-id"),10))===w.length-1?0:e+1),n.innerHTML='<img src="'+w[t][O]+'">',n.setAttribute("data-id",t),r.appendChild(n)}Promise.all(l).then(function(e){o.innerHTML="";var t=document.createElement("div");t.classList.add("static-anim"),o.appendChild(t);var r=document.createElement("img");r.src=w[0][O],r.setAttribute("data-id",0),t.appendChild(r);var n=document.createElement("div");n.classList.add("infinite-scroll"),o.appendChild(n);var L=o.getBoundingClientRect();for(;n.scrollHeight<=L.height;)A();o.addEventListener("wheel",helpers.throttledEvent(v,5)),o.addEventListener("touchstart",m,!1),o.addEventListener("touchmove",helpers.throttledEvent(p,5),!1),o.addEventListener("touchend",h,!1),o.addEventListener("touchcancel",h,!1),new MutationObserver(function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if("attributes"===o.type&&"style"===o.attributeName){var l=document.querySelector(".infinite-scroll"),c=j(),s=l.firstChild,u=l.lastChild;Math.abs(c)>s.offsetHeight?(s.remove(),l.style.transform="translateY(0)"):l.offsetHeight-u.offsetHeight-Math.abs(c)>L.height&&u.remove(),0<c?function(){var e=0,t=document.querySelector(".infinite-scroll"),r=document.createElement("div");r.classList.add("infinite-scroll__item");var n=parseInt(t.firstChild.getAttribute("data-id"),10);e=0===n?w.length-1:n-1;r.innerHTML='<img src="'+w[e][O]+'">',r.setAttribute("data-id",e),t.prepend(r),t.style.transform="translateY("+-r.offsetHeight+"px)"}():L.height+Math.abs(c)>l.offsetHeight&&A();var d,f,m=document.getElementsByClassName("infinite-scroll__item"),p=document.querySelector(".static-anim"),h=p.getBoundingClientRect(),v=void 0,y=9999,g=!0,b=!1,_=void 0;try{for(var q,M=m[Symbol.iterator]();!(g=(q=M.next()).done);g=!0){var C=q.value,S=C.getBoundingClientRect(),E=Math.abs(S.top-h.top);E<y&&(y=E,v=C)}}catch(e){b=!0,_=e}finally{try{g||null==M.return||M.return()}finally{if(b)throw _}}v.getBoundingClientRect().top<=h.top&&(d=p.querySelector("img"),f=v.getAttribute("data-id"),d.src=w[f][O],d.setAttribute("data-id",f))}}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}).observe(n,{attributes:!0}),f(-80,4e3)}).catch(function(e){return console.error(e)})}