"use strict";require("./fonts.less"),require("./styles.less");var _projects=_interopRequireDefault(require("./projects.json")),_=_interopRequireDefault(require("./media/*.*")),_contentInfo=_interopRequireDefault(require("./content-info.md"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var defaultRoute="/",pages=[{title:"home",route:"/",content:"loadProjects()"},{title:"about",route:"/about",content:"content-info.md"}];function initApp(){navigateToCurrentURL();var e=document.querySelectorAll('a[data-link="page"]'),t=!0,r=!1,n=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){a.value.addEventListener("click",handlePageLink)}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}function handlePageLink(e){e.preventDefault(),buildPage({route:e.target.getAttribute("href")})}function navigateToCurrentURL(){for(var e=window.location.pathname,t=[],r=0,n=pages;r<n.length;r++){var a=n[r];t.push(a.route)}var o=defaultRoute;t.includes(e)&&(o=e),buildPage({route:o})}function buildPage(e){var t,r=document.getElementById("main"),n=!(r.innerHTML=""),a=!1,o=void 0;try{for(var i,u=pages[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var l=i.value;l.route==e.route&&(t=l)}}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}if(window.history.pushState(e,"",t.route),"home"===t.title)loadProjects();else if("about"===t.title){var c=document.querySelector("#nav a");c.href="/",c.innerHTML="work",r.innerHTML='<article class="about">'+_contentInfo.default+"</article>"}}function loadProjects(){var e=document.querySelector("#nav a");e.href="/about",e.innerHTML="about";var t=document.createElement("div");t.classList.add("projects-container"),main.appendChild(t);var n,a,o,r=document.createElement("div");for(r.classList.add("projects"),t.appendChild(r);r.scrollHeight<=window.innerHeight;)l();function i(e){e.preventDefault();var t=e.changedTouches,r=-1*(a-t[0].pageY);o=requestAnimationFrame(function e(t){r=Math.min(Math.max(r,-80),80);u(r);(0<r||r<0)&&(o=window.requestAnimationFrame(e),0<r?r--:r<0&&r++)})}function u(e){console.log(e);var t,r=document.querySelector(".projects"),n=window.getComputedStyle(r).getPropertyValue("transform");if("none"===n)r.style.transform="translateY(0)",t=0;else{var a=n.match(/matrix.*\((.+)\)/)[1].split(", ");t=parseInt(a[5],10)}t+=e,r.style.transform="translateY("+t+"px)";var o=r.firstChild,i=r.lastChild;Math.abs(t)>o.offsetHeight?(o.remove(),r.style.transform="translateY(0)"):r.offsetHeight-i.offsetHeight-Math.abs(t)>window.innerHeight&&i.remove(),0<=t?function(){var e=0,t=document.querySelector(".projects"),r=document.createElement("div");r.classList.add("projects__project");var n=parseInt(t.firstChild.getAttribute("data-id"),10);e=0===n?_projects.default.projects.length-1:n-1;r.innerHTML='<img src="'+_.default["11_Laser"].jpg+'">\n  <div>'+_projects.default.projects[e].title+"</div>",r.setAttribute("data-id",e),t.prepend(r),t.style.transform="translateY("+-r.offsetHeight+"px)"}():window.innerHeight+Math.abs(t)>r.offsetHeight&&l()}function l(){var e=0,t=document.querySelector(".projects"),r=document.createElement("div");if(r.classList.add("projects__project"),t.hasChildNodes()){var n=parseInt(t.lastChild.getAttribute("data-id"),10);e=n===_projects.default.projects.length-1?0:n+1}r.innerHTML='<img src="'+_.default["11_Laser"].jpg+'">\n    <div>'+_projects.default.projects[e].title+"</div>",r.setAttribute("data-id",e),t.appendChild(r)}t.addEventListener("wheel",throttledEvent(function(e){e.preventDefault(),u(-1*e.deltaY)},5)),t.addEventListener("touchstart",function(e){e.preventDefault();var t=e.changedTouches;n=t[0].pageY,cancelAnimationFrame(o)},!1),t.addEventListener("touchmove",throttledEvent(function(e){e.preventDefault(),a=n;var t=e.changedTouches,r=-1*(n-t[0].pageY);n=t[0].pageY,u(r)},5),!1),t.addEventListener("touchend",i,!1),t.addEventListener("touchcancel",i,!1)}function throttledEvent(t,r){var n;return function(e){n||(t(e),n=setTimeout(function(){n=null},r))}}function playAnim(e){var t=document.querySelector(".tiny-anim");t.currentTime+=.05,console.log(t.currentTime),t.currentTime>=t.duration?t.currentTime=0:t.currentTime<=0&&(t.currentTime=t.duration)}function controlAnim(e){var t=.005*e.deltaY,r=document.querySelector(".tiny-anim");r.currentTime+=t,console.log(r.currentTime+"s"),r.currentTime>=r.duration?r.currentTime=0:r.currentTime<=0&&(r.currentTime=r.duration)}function map(e,t,r,n,a){return(e-t)*(a-n)/(r-t)+n}initApp();